package com.apm.models;

import com.apm.core.ConfigManager.Severity;

/**
 * Represents a cache poisoning vulnerability
 */
public class CachePoisonVulnerability {

    private final VulnerabilityType type;
    private final String title;
    private final String description;
    private final Severity severity;
    private final String affectedParameter;
    private final String evidence;
    private final String proofOfConcept;
    private final String remediation;
    private final boolean verified;

    public CachePoisonVulnerability(VulnerabilityType type, String title, String description,
            Severity severity, String affectedParameter, String evidence,
            String proofOfConcept, String remediation, boolean verified) {
        this.type = type;
        this.title = title;
        this.description = description;
        this.severity = severity;
        this.affectedParameter = affectedParameter;
        this.evidence = evidence;
        this.proofOfConcept = proofOfConcept;
        this.remediation = remediation;
        this.verified = verified;
    }

    public VulnerabilityType getType() {
        return type;
    }

    public String getTitle() {
        return title;
    }

    public String getDescription() {
        return description;
    }

    public Severity getSeverity() {
        return severity;
    }

    public String getAffectedParameter() {
        return affectedParameter;
    }

    public String getEvidence() {
        return evidence;
    }

    public String getProofOfConcept() {
        return proofOfConcept;
    }

    public String getRemediation() {
        return remediation;
    }

    public boolean isVerified() {
        return verified;
    }

    @Override
    public String toString() {
        return String.format("[%s] %s - %s", severity, title, affectedParameter);
    }

    public enum VulnerabilityType {
        UNKEYED_HEADER("Unkeyed Header Cache Poisoning"),
        PARAMETER_CLOAKING("Parameter Cloaking"),
        FAT_GET("Fat GET Cache Poisoning"),
        CACHE_DECEPTION("Web Cache Deception"),
        UNKEYED_COOKIE("Unkeyed Cookie"),
        CACHE_KEY_INJECTION("Cache Key Injection");

        public final String displayName;

        VulnerabilityType(String displayName) {
            this.displayName = displayName;
        }
    }
}
